<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SAME54_ED043WC3__4_1_5: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Doxygen_Ineltek_Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAME54_ED043WC3__4_1_5
   &#160;<span id="projectnumber">1.5</span>
   </div>
   <div id="projectbrief">Eink ITE Xplained Pro Example Code - SAME54 - ED043WC3 - ASF4</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SAME54_ED043WC3__4_1_5 Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>This example code demonstrates the use of the Eink ITE Xplained Pro (ED043WC3) with the SAME54 Xplained Pro board, making use of Ineltek's Eink ASF4 Software Library (version 1.5).<br />
 It uses the following hardware:</p><ul>
<li>the SAME54 Xplained Pro.</li>
<li>the Eink ITE Xplained Extension (ED043WC3) on EXT1 and EXT2.</li>
</ul>
<h1><a class="anchor" id="setup_steps"></a>
Setup Steps</h1>
<h2><a class="anchor" id="setup_prerequisites"></a>
Prerequisites</h2>
<p>In order to use the Eink ASF4 Software Library, several software components must be added from the Atmel START. These are:</p><ul>
<li>Delay (driver)</li>
<li>PORT (driver)</li>
<li>SPI (driver) - SPI_Master_Sync mode</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Note that this library is not compatible with the ASF Wizard in Atmel Studio - for this you must use the Eink ASF3 Software Library - no longer in development.</dd></dl>
<h2><a class="anchor" id="setup_pins"></a>
Pinmux Configuration</h2>
<p>Next we need to define the pins for the display and ensure they are labeled correctly within Atmel START. Pin directions are automatically configured by the library, so any direction can be set within START. The following pins are required with the following labels:</p><ul>
<li><b>EINK_RST</b> : Reset pin - <em>EXT1 Pin 3</em></li>
<li><b>EINK_HOST_RDY</b> : Host ready pin - <em>EXT1 Pin 6</em></li>
<li><b>EINK_SPI_CSB</b> : SPI chip select pin - <em>EXT1 Pin 15</em></li>
<li><b>EINK_SPI_SCK</b> : SPI clock pin - <em>EXT1 Pin 18</em></li>
<li><b>EINK_SPI_MOSI</b> : SPI Data In pin - <em>EXT1 Pin 16</em></li>
<li><b>EINK_SPI_MISO</b> : SPI Data Out pin - <em>EXT1 Pin 17</em></li>
</ul>
<p>We also need to setup the SPI module in SPI_Master_Sync mode with the name <b>SPI_0</b>.</p>
<h2><a class="anchor" id="setup_project"></a>
Atmel Studio Project Configuration</h2>
<p>Once your Atmel Studio project has been generated from Atmel START, we now need to add the library to the compiler include paths:<br />
 See Project Properties &gt; Toolchain &gt; ARM/GNU C Compiler &gt; Directories:</p><ul>
<li>&lt;BASE_DIR&gt;/eink_asf4_1_5</li>
<li>&lt;BASE_DIR&gt;/eink_asf4_1_5/fonts</li>
</ul>
<p>Finally the following line must be added directly below the Atmel START include statement: </p><div class="fragment"><div class="line"><span class="preprocessor">#define eink_project_excluded</span></div><div class="line"><span class="preprocessor">#include &lt;atmel_start.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="eink__asf4__1__5_8h.html">eink_asf4_1_5.h</a>&gt;</span></div></div><!-- fragment --><p>In this example project, the library is located elsewhere and not in the Solution Explorer, hence why this has been included.</p>
<p>To initialize the Eink library for use with the IT8951, the <a class="el" href="it8951_8c.html#a36b6914c81913a682f925b5e73e72d45" title="Initialize IT8951 controller and Eink display. It will also write the display buffers to all zeros...">eink_it8951_init()</a> function must be called. This function only requires two parameters to be passed with it, the display rotation and whether or not to update the display after initialisation. The IT8951 uses the firmware file in its external flash to retrieve the majority of its settings.</p>
<p>Example Code:</p>
<div class="fragment"><div class="line"><a class="code" href="it8951_8c.html#a36b6914c81913a682f925b5e73e72d45">eink_it8951_init</a>(ROTATE_270, <span class="keyword">false</span>);</div></div><!-- fragment --><h1><a class="anchor" id="gfx_library"></a>
GFX Library</h1>
<p>Once initialized, the library stores a buffer in RAM in order keep track of the canvas - initially it is all white. There are several primitive function that allow for some data to be written to the canvas:</p><ul>
<li><a class="el" href="eink__gfx__graphics_8c.html#ad69eaa96906073d9c340a6ea62e07b0f" title="Fill display buffers with a single color. ">gfx_eink_graphics_fill_screen()</a></li>
<li><a class="el" href="eink__gfx_8h.html#a32add6f922349d1195d3cf120248bd7f" title="Load Mono Image function. ">gfx_eink_load_mono_image()</a></li>
<li><a class="el" href="eink__gfx__graphics_8c.html#a644b6480d3bc1e706f63318c2a8591c7" title="Add a line to the display buffer from (x0,y0) to (x1,y1). ">gfx_eink_graphics_draw_line()</a></li>
<li><a class="el" href="eink__gfx__graphics_8c.html#a6001328f0e03f6c82f397438eaeff214" title="Add a rectangle to the display buffer starting at (x0,y0) with set width and height. ">gfx_eink_graphics_draw_rect()</a></li>
<li><a class="el" href="eink__gfx__text_8c.html#a7c45e00fb00d9841aa986157d2a0c224" title="Write a string of data starting at (x,y) ">gfx_eink_text_write_string()</a></li>
<li><a class="el" href="eink__gfx_8h.html#a8d8556ab6c3b927ef42c7696b4c15c7c" title="Set Pixel function. ">gfx_eink_set_pixel()</a></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Note that the standard GFX functions only allow graphics to be drawn in black and white when using the IT8951.</dd></dl>
<p>Since the IT8951 supports 4-bit greyscale displays, there are several functions that are also available:</p><ul>
<li><a class="el" href="eink__gfx__graphics_8c.html#a91129077c22ce578e40823b823bc5e9b" title="Fill display buffers with a single color. ">gfx_eink_graphics_fill_screen_raw()</a></li>
<li><a class="el" href="eink__gfx_8h.html#ad8513a6686293dcf8dc266f0d1bcefff" title="Load 4-bit Greyscale Image function. ">gfx_eink_load_4bgrey_image()</a></li>
<li><a class="el" href="eink__gfx__graphics_8c.html#ac013afb36971593656126328249400b7" title="Add a line to the display buffer from (x0,y0) to (x1,y1). ">gfx_eink_graphics_draw_line_raw()</a></li>
<li><a class="el" href="eink__gfx__graphics_8c.html#a0c3d1a83f4260e8155c067eaa71202c2" title="Add a rectangle to the display buffer starting at (x0,y0) with set width and height. ">gfx_eink_graphics_draw_rect_raw()</a></li>
<li><a class="el" href="eink__gfx__text_8c.html#af938d962eca4b61f71b4b0cd8422d3a3" title="Write a string of data starting at (x,y) with. ">gfx_eink_text_write_string_raw()</a></li>
<li><a class="el" href="eink__gfx_8h.html#a84df537a4e04db4e00319b2d1d580498" title="Set Pixel with raw value function. ">gfx_eink_set_pixel_raw()</a></li>
</ul>
<p>The canvas buffer can be uploaded to the display controller with the use of <a class="el" href="eink__gfx_8h.html#a910f87d8ecfa86c35a4ce27337d77ba5" title="Put Display Buffer function. ">gfx_eink_put_display_buffer()</a></p>
<p>If you decide to load the buffer but refresh the display later on, this can be achieved using the <a class="el" href="eink__gfx_8h.html#a7bb3171f1bbfe2cf5b6f59ee72d3bb10" title="Refresh Display function. ">gfx_eink_refresh_display()</a></p>
<p>There are several more options available for the IT8951 to do partial uploads of data, partial updates of the display and updates using several modes. The following functions can be used:</p><ul>
<li><a class="el" href="eink__gfx_8h.html#a910f87d8ecfa86c35a4ce27337d77ba5" title="Put Display Buffer function. ">gfx_eink_put_display_buffer()</a></li>
<li><a class="el" href="eink__gfx_8h.html#a5093a69b7a5914cf1e12003dc7238332" title="Put Partial Display Buffer function. ">gfx_eink_put_partial_display_buffer()</a></li>
<li><a class="el" href="eink__gfx_8h.html#a7bb3171f1bbfe2cf5b6f59ee72d3bb10" title="Refresh Display function. ">gfx_eink_refresh_display()</a></li>
<li><a class="el" href="eink__gfx_8h.html#a82635ed58b74d78e3db1b79cdd8ecb9f" title="Refresh Display with mode function. ">gfx_eink_refresh_display_mode()</a></li>
<li><a class="el" href="eink__gfx_8h.html#ad4588a30c0c60ff434f20c314da9fc09" title="Refresh Partial Display function. ">gfx_eink_refresh_partial_display()</a></li>
</ul>
<h1><a class="anchor" id="files"></a>
Main Files</h1>
<ul>
<li><a class="el" href="main_8c.html" title="Eink ITE Xplained Pro Demo - SAME54 - ED043WC3. ">main.c</a> : Initialize the Eink display and displays some demo screens.</li>
</ul>
<h1><a class="anchor" id="usage"></a>
Usage</h1>
<ol type="1">
<li>Build the program and download it into the board.</li>
<li>Wait for the LED0 on the SAM E54 Xplained Pro to turn off - indicates initialization is complete.</li>
<li>Demo will run automatically.</li>
</ol>
<h1><a class="anchor" id="compinfo"></a>
Compilation Information</h1>
<p>This software was written for the GNU GCC compiler using Atmel Studio 7.0 and requires ASF version 4 (originally compiled from Atmel START version 1.7.279). Other compilers may or may not work.</p>
<h1><a class="anchor" id="contactinfo"></a>
Contact Information</h1>
<p>For further information, visit <a href="http://www.ineltek.com">Ineltek</a>.<br />
</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
